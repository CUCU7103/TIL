# 자바의 메모리 구조

![image](https://github.com/user-attachments/assets/5d2e05d5-5b96-4f79-a689-3ef3aa2bb17b)


- #### 메서드 영역 

  - 메서드 영역은 **프로그램을 실행하는데 필요한 공통데이터를 관리**한다.

  - 이 영역은 프로그램의 모든 영역에서 공유되어진다.

  - **클래스 정보**: 클래스의 실행 코드(바이트 코드), 필드, 메서드와 생성자 코드 등 모든 실행 코드가 존재한다.

  - static 영역:  ` static ` 변수들을 보관한다. 뒤에서 자세히 설명한다. 

  - 런타임 상수 풀: 프로그램을 실행하는데 필요한 공통 리터럴 상수를 보관한다.

    -  예를 들어서 프로그램에  ` "hello" ` 라는 리터럴 문자가 있으면 이런 문자를 공통으로 묶어서 관리한다. 이 외에도 프로그램을 효율 적으로 관리하기 위한 상수들을 관리한다.

    

- #### 스택 영역

  - 스택 영역(Stack Area) : **자바 실행 시, 하나의 실행 스택이 생성된다**. 
  - 각 스택 프레임은 **지역 변수**, 중간 연산 결과, 메서드 호출 정보 등을 포함한다.
    - 스택 프레임: 스택 영역에 쌓이는 네모 박스가 하나의 스택 프레임이다. 
    - 메서드를 호출할 때 마다 하나의 스 택 프레임이 쌓이고, 메서드가 종료되면 해당 스택 프레임이 제거된다.
    - **스택 영역을 사용해서 메서드 호출과 지역 변수(매개변수 포함)를 관리**한다.

예시

```java
public class JavaMemoryMain1 {
    public static void main(String[] args) {
        System.out.println("main start");
        method1(10);
        System.out.println("main end");
    }
    static void method1(int m1) {
        System.out.println("method1 start");
        int cal = m1 * 2;
        method2(cal);
        System.out.println("method1 end");
    }
    static void method2(int m2) {
        System.out.println("method2 start");
        System.out.println("method2 end");
    }
}
```
![image](https://github.com/user-attachments/assets/d55d6f6a-f2e5-4d9a-b80e-17a36cf554bd)

![image](https://github.com/user-attachments/assets/673718da-65ff-4e68-91a9-717af03e8112)

![image](https://github.com/user-attachments/assets/d4e4dfde-a999-4b5e-b08a-1b4f5b925c31)



- 힙 영역(Heap Area)  :
  -  **객체(인스턴스)와 배열이 생성되는 영**역이다. 
  - 가비지 컬렉션(GC)이 이루어지는 주요 영역이며, 더 이상 참조되지 않는 객체는 GC에 의해 제거된다.
  - **new 키워드(생성자)를 통해 생성된 인스턴스가 생성되는 영역**. 모든 스레드가 공유합니다.





### 멤버변수의 종류

 **인스턴스 변수** : ` static` 이 붙지 않은 멤버 변수 

- ` static` 이 붙지 않은 멤버 변수는 인스턴스를 생성해야 사용할 수 있고, 인스턴스에 소속되어 있다. 
- 따라서 인스턴스 변수라 한다. 인스턴스 변수는 인스턴스를 만들 때 마다 새로 만들어진다. 

**클래스 변수** : ` static` 이 붙은 멤버 변수

- 클래스 변수, 정적 변수, ` static` 변수등으로 부른다. **용어를 모두 사용하니 주의하자** 
- ` static` 이 붙은 **멤버 변수는 인스턴스와 무관하게 클래스에 바로 접근해서 사용할 수 있고**, 클래스 자체에  소속되어 있다.  따라서 **클래스 변수**라 한다. 
- **클래스 변수는 자바 프로그램을 시작할 때 딱 1개가 만들어진다. 인스턴스와는 다르게 보통 여러곳에서 공유하는 목적으로 사용된다**



### 변수와 생명주기

**지역 변수(매개변수 포함) ** , stack 영역에 위치합니다.

- 지역변수는 스택(stack) 영역에 있는 스택 프레임 안에 보관된다. 
- 메서드가 종료되면 스택 프레임도 제거 되는데 이때 해당 스택 프레임에 포함된 지역 변수도 함께 제거된다. 따라서 지역 변수는 생존 주기가 짧다.

 **인스턴스 변수** (heap 영역에 위치함.)

- **인스턴스에 있는 멤버 변수를 인스턴스 변수라 한다**.
- 인스턴스 변수는 힙 영역을 사용한다. 
- 힙 영역은 GC(가비지 컬렉션)가 발생하기 전까지는 생존하기 때문에 보통 지역 변수보다 생존 주기가 길다.

**클래스 변수**(static 변수)

- **클래스 변수는 메서드 영역의 static 영역에 보관되는 변수**이다. 
- 메서드 영역은 프로그램 전체에서 사용하는 공용 공간이다. 클래스 변수는 해당 클래스가 JVM에 로딩 되는 순간 생성된다. 
- 그리고 JVM이 종료될 때 까지 생명주기가 어어진다.  **따라서 가장 긴 생명주기를 가진다.**















