# 멀티 프로세스 vs 멀티 스레드

### 프로세스와 스레드

1. 프로세스

   - 운영체제 안에서 실행 중인 프로그램을 프로세스라고 합니다.

   - 프로세스는 하나 이상의 스레드를 반드시 포함합니다.

   - 프로세스는 독립된 메모리 공간입니다.

   - 프로세스는 실행 중인 프로그램의 인스턴스 입니다.

   - 프로세스는 스택, 힙 , 데이터 , 코드 영역으로 구성되어져 있습니다.

     - 스택

       - 실행할 프로그램의 코드가 저장되는 부분
       - 후입선출(LIFO)로 데이터를 저장하고 처리합니다
         - 브라우저에서 사용자가 방문한 페이지가 스택에 저장되어 뒤로 가기 버튼을 누를때 마다 최근 방문한 페이지로 이동합니다.
       - JVM에서 메서드 호출시 생성되는 지역변수와 반환 주소가 저장되어지는 영역입니다.

     - 힙

       - 프로그램이 실행되는 동안 필요할 때 마다 메모리를 가져다 쓸 수 있는 곳이며 사용이 끝나면 그 공간을 다시 반환할 수 있습니다.
       - 동적으로 크기가 결정되거나 장기간 데이터를 유지해야 하는 프로그램에서 유용합니다.
         - 동적으로 크기가 결정된다는 말은 프로그램이 실행되는 동안에 메모리의 크기와 수명이 결정된다는 의미입니다.
         - 동적으로 할당된 메모리는 사용한 후에 반드시 해제하여야 합니다. 메모리 누수와 같은 문제가 발생할 수 있습니다.
           - jvm에서 GC가 수행되어지는 이유 

     - 데이터 

       - 프로그램이 무엇을 사용해야 하는지에 대한 정보를 제공합니다.
       - 데이터 영역에는 프로그램이 시작될때 생성되어 프로그램이 종료될 때 까지 유지되는 정보 , 예를 들어 전역변수(global variable)과, 정적 변수(static variable)가 저장됩니다.

     - 코드

       - 실행할 프로그램의 코드가 저장되는 부분입니다.
       - 프로그램이 '무엇을 해야하는지'에 대한 정보를 제공합니다.
       - 프로그램이 수행해야 하는 모든 명령어가 저장됩니다.

       ![image-20250212001127922](https://raw.githubusercontent.com/CUCU7103/save-image-repo/main/image/image-20250212001127922.png)

   

2. 스레드

   - 프로세스는 하나 이상의 스레드를 반드시 포함합니다
     - 그래야 프로그램이 실행될 수 있습니다.
   - **스레드는 프로세스 내에서 실행되어지는 작업의 단위입니다.**
   - 한 프로세스에는 여러개의 스레드가 존재할 수 있습니다.
     - 단일 스레드
       - 한 프로세스 내에 하나의 스레드만 존재
     - 멀티 스레드 
       - 한 프로세스 내에 여러 스레드가 존재
   - 한 프로세스 내에 존재하는 스레드들은 프로세스가 제공하는 동일한 메모리 공간을 공유합니다.

   

   ![image-20250212001325466](https://raw.githubusercontent.com/CUCU7103/save-image-repo/main/image/image-20250212001325466.png)

<br>

##  Context switching이란?

- **CPU가 실행 중인 작업(프로세스 또는 스레드)을 멈추고, 다른 작업으로 전환할 때 발생하는 과정**

  - 현재 작업의 상태를 저장하고, 새 작업의 상태를 불러오는 작업이 이루어집니다.

- 왜 필요할까요?

  - **멀티태스킹**: 여러 작업을 동시에 실행하는 것처럼 보이게 하기 위해 필요합니다. 

    - CPU는 (코어 1개 기준)한 번에 하나의 프로세스만을 실행할 수 있습니다.

      - 이럴 경우 예를 들으면 음악을 들으면서 웹 브라우저를 사용할 수없고, 음악 프로그램이 끝난 뒤에야 웹 브라우저를 사용할 수 있습니다.

      - 이를 해결하기 위해 하나의 cpu 코어로 여러 프로그램을 동시에 사용할 수있는 기법인 '멀티태스킹'이 등장하였습니다.

      - **멀티 태스킹은 시분할기법(프로그램의 실행시간을 분할해서 마치 동시에 실행되는 것 처럼 보이게 하는) 을 사용하여 cpu 코어가 하나만 있어도 마치 여러 프로그램이 동시에 실행되는 것 처럼 보이게 합니다.**

        

  - **공정성**: 모든 작업이 CPU 시간을 공평하게 나누어 사용할 수 있도록 합니다.

  - **우선순위 처리**: 중요한 작업(예: 긴급 인터럽트)이 빠르게 실행되도록 합니다

<br>

## 멀티 프로세스

- 여러개의 프로세스를 사용하여 동시에 두 가지 이상의 일을 수행하는 것을 말합니다.
  - **여러 개의 프로세스를 병렬적으로 실행**하여 작업을 처리하는 방식입니다.
- 특정 프로세스에서 문제가 발생하더라도 다른 프로세스에 영향을 미치지 않습니다
  - 이는 곧 격리성과 신뢰성이 높다는 장점이 있습니다
- 작업량이 많을 수록 Context switching 비용이 증가합니다.

- **특징**: 
  - 각 프로세스는 독립적인 실행 단위로, 자신의 메모리(Code, Data, Heap, Stack)를 따로 가집니다.
  - 프로세스 간 통신은 IPC(Inter-Process Communication) 기법(파이프, 소켓 등)을 사용해야 하며, 이 과정은 복잡하고 비용이 큽니다.
  - 하나의 프로세스가 문제가 생겨도 다른 프로세스에 영향을 주지 않습니다.
  - Context Switching(문맥 교환)이 상대적으로 느립니다.
- **장점**:
  - 안정성이 높으며, 하나의 프로세스가 다운되더라도 다른 프로세스에 영향을 주지 않음.
  - 동기화 문제가 적음(자원을 공유하지 않기 때문).
- **단점**:
  - 메모리와 시스템 자원 소모가 큼.
  - Context Switching 비용이 높음.

<br>

## **멀티 스레드(Multi-Thread)**

- 멀티 스레드는 **하나의 프로세스 내에서 여러 스레드를 실행**하여 작업을 처리하는 방식입니다. 
- 스레드는 같은 프로세스 내에서 자원을 공유하며, 각각 독립적인 실행 흐름을 가집니다.

- **특징**:

  - 스레드는 같은 프로세스 내에서 Code, Data, Heap 영역을 공유하며, Stack은 독립적으로 가집니다.
  - 스레드 간 통신이 쉽고 빠르며, 별도의 IPC가 필요하지 않습니다.Context Switching 비용이 낮습니다.

- **장점**: 

  - 메모리 사용량이 적고 시스템 자원 소모를 줄일 수 있음.
  - 빠른 Context Switching으로 응답성과 효율성이 높음.데이터 교환이 간단하여 작업 간 협력이 용이함.

- **단점**:

  - 자원을 공유하기 때문에 동기화 작업이 필수적이며, 동기화 문제로 인해 병목 현상이 발생할 수 있음.
  - 하나의 스레드가 비정상 종료되면 전체 프로세스가 영향을 받을 수 있음.

  

![image-20250212004721689](https://raw.githubusercontent.com/CUCU7103/save-image-repo/main/image/image-20250212004721689.png)
