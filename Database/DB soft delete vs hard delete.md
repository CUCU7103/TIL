# DB soft delete vs hard delete

### Soft Delete (논리적 삭제)

- 논리적 삭제는 데이터베이스에서 레코드를 실제로 삭제하지 않고, 특정 플래그나 상태 값을 변경하여 해당 레코드가 삭제된 것으로 간주되도록 처리하는 방법입니다..



#### 방법

- 테이블에 `is_deleted`, `deleted_at` 등의 삭제 여부를 표시할 컬럼을 추가합니다.
  - 데이터를 삭제할 때 해당 컬럼의 값을 변경하여 삭제된 상태를 표시합니다.
  - 보통 boolean 형태인 Y/N를 주로 사용합니다.



#### 장점

- 데이터의 복구가 용이합니다.
- 삭제 이력을 관리할 수있어 기록 보관에 유리합니다.
  - 어플리케이션 사용자 입장에서는 삭제된 것 처럼 보이지만 실제로는 db에 남겨져 있기 때문입니다.

#### 단점

- 데이터 용량 증가 : 
  - 삭제된 데이터도 테이블에 남아있게 되므로 테이블의 크기가 커질 수있습니다.
- 복잡성 : 
  - 데이터 조회시 삭제된 것들을 제외하고 조회해야 하기에 쿼리문이 복잡해 질 수 있습니다.
- 성능 저하 :
  -  데이터 용량 증가에 따른 성능 저하가 발생할 수 있습니다.



### Hard Delete (물리적 삭제)

- 데이터베이스에서 데이터를 실제로 삭제하여 데이터가 완전히 제거되는 방법입니다.

#### 방법

- delete 문을 사용하여 데이터를 제거합니다. 
- 필요에 따라 `TRUNCATE` 명령어를 사용합니다.



#### 장점

- 데이터베이스 용량 절감: 
  - 불필요한 데이터를 완전히 제거하여 데이터베이스의 크기를 줄일 수있습니다.
- 간단한 쿼리:
  - 삭제된 데이터를 제외하기 위한 추가 조건이 필요 없으므로 쿼리가 간단해집니다.
- 성능 향상
  - 데이터가 줄어들어서 조회성능이 향상 될 수 있습니다.



#### 단점

- 데이터의 복구가 어렵거나 불가능합니다.
- 추후 삭제 내역을 확인하기 어렵습니다.



#### 결론

> 테이블에 특성에 따라서 삭제 정책을 결정해야 합니다.
>
> 데이터를 장기간 보관해야하거나, 삭제한 내역을 확인할 필요가 있거나, 데이터의 중요도가 높은 테이블의 경우는 soft delete를 통해서 테이블에 남겨두어야 합니다.
>
> 반대의 경우, 데이터의 중요도가 낮거나, 삭제한 내역을 확인할 필요가 없고, 데이터가 너무 많이 쌓이는 테이블의 경우에는 hard delete를 통해서 데이터베이스에서 데이터를 완전히 삭제하는것 이 좋다고 생각되어집니다.

