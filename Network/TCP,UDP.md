# TCP vs UDP 

- ### TCP 

  - 신뢰할 수 있는 통신을 위한 연결형 프로토콜입니다.

- ### 특징

  > [!NOTE]
  >
  > - 연결형 서비스로 가상 회선 방식을 제공
  >   - **3-way handshaking 과정을 통해 연결을 설정하고,**
  >   - **4-way handshaking 과정을 통해 연결을 해제한다.**
  > - 흐름 제어(Flow control)
  >   - 데이터 처리 속도를 조절하여 수신자의 버퍼 오버플로우를 방지
  > - 혼잡 제어(Congestion control)
  >   - 네트워크 내의 패킷 수가 과도하게 증가하지 않도록 방지
  > - 높은 신뢰성을 보장
  >   - 신뢰성이 높은 전송을 하기 때문에 UDP보다 속도가 느림
  > - 전이중(Full-Duplex), 점대점(Point to Point) 방식
  >   - 전이중(Full-Duplex) : 전송이 양방향으로 동시에 일어날 수 있다.
  >   - 점대점(Point to Point) : 각 연결이 정확히 2개의 종단점을 가지고 있다.

  - 가상 회선 방식을 제공한다는 것은 발신지와 수신지를 연결하여 패킷을 전송하기 위한 논리적 경로를 배정한다는 뜻입니다.
    - 패킷은 패킷 교환 네트워크상에서 송수신되는 메시지의 단위입니다.

  - 즉 3-way handshaking 과정은 발신지와 수신지 사이에 논리적인 접속(세션)을 성립하는 과정을 의미합니다. 

  - 그리고 데이터 송수신 과정에서  재전송을 기반으로 다양한 오류를 제어하고 , 흐름제어를 통해서 처리할 수 있을만큼의 데이터를 주고 받으며, 혼잡제어를 통해서 네트워크가 혼잡한 정도에 따라 전송량을 조절합니다.

  - 이러한 과정을 통해서 TCP는 연결형 프로토콜임을 알 수있고 , 신뢰성을 보장하게 됩니다.

  - 하지만 이러한 기능 때문에 UDP보다 속도가 느리게 되어집니다.
  - 그렇기에 TCP는 연속성보다 신뢰성 있는 전송이 중요할 때 사용하는 프로토콜입니다.  예를 들면, 파일 전송, 메일 전송등이 있습니다.

  

- TCP의 통신단계

  - 연결 수립  -> 데이터 송수신 -> 연결 종료

- 연결 수립

  - #### 3 way handshake

    - tcp의 연결 수립은 3 way handshake를 통해 이루어집니다.

   ![image](https://github.com/user-attachments/assets/7930e73c-dc73-48f9-9741-c8f0f116fd02)


    

    - 액티브 오픈

      - 서버 - 클라이언트 관계에서 클라이언트에 의해 수행됩니다.
      - 처음 연결하는 호스트의 연결 수립 과정을 이라고 합니다.

      

    - 패시브 오픈 

      - 연결 요청을 받고 나서 요청에 따라 연결을 수립해주는 과정입니다.
      - 주로 서버에 의해서 수행되어집니다.

      

- 3 way handshake를 간단히 표현하면 아래와 같습니다.

  - Client -> Server : 내 말 들려?
  - Server -> Client : 어 잘 들려! 내 말은 들려?
  - Client -> Server : 잘 들려!
    

1. 먼저 Open 한 클라이언트가 SYN(내 말 들려?)를 보내고 SYN_SENT 상태로 대기한다.
2. 서버는 SYN-RECEIVED 상태로 바꾸고 SYN과 응답 ACK(어 잘 들려! 내 말은 들려?)를 보낸다.
3. SYN과 응답 ACK를 받은 클라이언트는 ESTABLISHED 상태로 변경하고 서버에게 응답 ACK(잘 들려!)를 보낸다.
4. 응답 ACK를 받은 서버는 ESTABLISHED 상태로 변경한다.

   

![image](https://github.com/user-attachments/assets/2dde5f55-ae2c-4347-84a2-fa62da996520)


- 데이터 송수신
  - 세그먼트의 순서번호 필드와 ,확인 응답번호 필드를 통해서 TCP의 신뢰성을 보장합니다.
  - 오류 제어
    - 재전송 기법을 사용하여 오류를 제어합니다.
    - 중복된 세그먼트 수신, 타임아웃 발생시 재전송을 진행합니다.
  - 흐름 제어
    - 수신자의 처리 속도를 고려하여 전송하도록 합니다.
  - 혼잡 제어
    - 네트워크의 혼잡도를 판단하고 혼잡한 정도에 따라 전송량을 조정합니다.



- 연결 종료

  - 4 way handshake

    - tcp의 연결 종료는 4 way handshake에 의해 이루어집니다.

  ![image](https://github.com/user-attachments/assets/d3dac48e-85ec-40e9-9c94-a283d4f8c3ea)
  

    - 엑티브 클로즈

      - 먼저 연결을 종료하려는 호스트에 의해 수행되어집니다.

        

    - 패시브 클로즈

      - 연결 종료 요청을 받아들이는 호스트에 의해 수행되어집니다.

    - 4 way handshake를 간단히 표현하면 아래와 같습니다.

      - Client -> Server : 나는 다 보냈어! 이제 끊자!

      - Server -> Client : 알겠어! 잠시만~

      - Server -> Client : 나도 끊을게!

      - Client -> Server : 알겠어!

        

    1. 먼저 close를 실행한 클라이언트가 FIN(연결 끊자!)을 보내고 FIN-WAIT-1 상태로 대기한다.
    2. 서버는 CLOSE-WAIT으로 바꾸고 응답 ACK(알겠어! 잠시만~)를 전달한다. 동시에 해당 포트에 연결되어 있는 애플리케이션에게 close를 요청한다.
    3. ACK를 받은 클라이언트는 상태를 FIN-WAIT-2로 변경한다.
    4. close 요청을 받은 서버 애플리케이션은 종료 프로세스를 진행하고 FIN(나도 끊을게!)을 클라이언트로 보내 LAST_ACK 상태로 바꾼다.
    5. FIN을 받은 클라이언트는 ACK(알겠어!)를 서버에 다시 전송하고 TIME-WAIT으로 상태를 바꾼다.
       TIME-WAIT에서 일정 시간이 지나면 CLOSE 된다. ACK를 받은 서버도 포트를 CLOSED로 닫는다
       

    ![image](https://github.com/user-attachments/assets/cd2e78a9-418f-4947-a52c-e1506c0de179)



### UDP

1. 비연결형 서비스로 데이터그램 방식을 제공한다.
   - 데이터의 전송 순서가 바뀔 수 있다.

2. 데이터 수신 여부를 확인하지 않는다.
   - TCP의 3-way handshaking과 같은 과정 X

3. 신뢰성이 낮습니다.
   - 흐름 제어(flow control)가 없어서 제대로 전송되었는지, 오류가 없는지 확인할 수 없다.

4. TCP보다 속도가 빠릅니다.
5. 스트리밍 서비스나 온라인 게임등 빠른 전송속도를 요구하는 환경에서 사용되어집니다.







