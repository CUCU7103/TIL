# HTTPS 동작방식

> [!NOTE]
> - HTTP는 Hyper-Text Transfer Protocol의 약자로, Hypertext인 HTML을 주고받기 위한 규약(protocol)입니다.
> - 웹 사이트를 구성하는 HTML 파일을 전송하기 위해 HTTP를 이용합니다. 
> - 하지만 HTTP는 전송중인 데이터를 가로채면 누구나 데이터를 읽을 수 있다는 보안상의 문제점이 존재합니다.

### HTTPS는 HTTP의 이런 보안적 문제를 해결한 프로토콜입니다.

![image](https://github.com/user-attachments/assets/c04aea67-6a61-42e1-9a22-e20caf08bc4f)


HTTP를 SSL 위에서 돌아가도록 하여 클라이언트와 서버가 주고 받는 데이터를 암호화 합니다.

즉 HTTPS는 주로 SSL/TLS 프로토콜을 사용하여 보안을 구현합니다.

SSL을 통해 보안을 구현하는데 관련된 것이  대칭키, 비대칭키 알고리즘 입니다.

- ### 대칭키 알고리즘

  - 암호화 복호화할 때 동일한 키가 사용되는 기법입니다.

  장점

  - **구현이 용이**하다.
  - 데이터를 암호화하기 위한 **연산이 빨라 대용량 데이터 암호화에 적합**하다.
  - **기밀성을 제공**한다.

  단점

  - 한쪽에서 다른 쪽으로 대칭키를 전송하는 과정이 필요하고 이 과정에서 탈취의 위험이 있음

    

![image](https://github.com/user-attachments/assets/f9667cc7-3b4a-4b99-b75c-a0aa0f7ccd7f)




- ### 비대칭키(공개키) 알고리즘

  - 서로 다른 키로 암호화와 복호화를 수행하는 암호화 기법입니다
  - 2개의 비대칭키를 관리하는데, 하나는 공개를 하고, 다른 하나는 서버에서만 관리하는 방식을 채택합니다. 
  - 여기서 공개하는 키는 `공개키`라고 하고, 비밀로 관리하는 키는 `개인키(비밀키)` 라고 합니다

  장점

  - **키 분배 및 키 관리가 용이**하다.

  - **기밀성, 무결성을 지원**한다.

  - **부인 방지 기능을 제공**한다.

    

- ### SSL

  - 웹서버와 웹 브라우저 간의 보안을 위해 만들어진 프로토콜 입니다.
  -  `SSL`은 대칭키 암호화 방식과 개인키 암호화 방식을 모두 사용하여 각각의 단점을 보완해줍니다.



## HTTPS 의 동작방식

- #### 1) 클라이언트가 서버에 연결 요청

  - 사용자가 브라우저에 HTTPS URL을 입력하면, 클라이언트(브라우저)는 서버에 SSL/TLS 연결을 요청합니다.

  ![image](https://github.com/user-attachments/assets/37f4ee80-10d4-4842-86c5-712e91a240c8)


  #### 2) 서버가 인증서 전송

  - 서버는 SSL/TLS 인증서를 클라이언트에 전송합니다. 

  - 이 인증서에는 서버의 공개 키와 서버의 신원을 확인할 수 있는 인증 기관

    (Certificate Authority, CA)의 디지털 서명이 포함됩니다.

    - 서버는 개인키를 가지고있다 
      - why? 비대칭키 알고리즘을 사용하기때문

  ![image](https://github.com/user-attachments/assets/94dd7b2b-611c-4c22-b912-f24b9f402e66)


  #### 3) 클라이언트가 인증서 검증

  - 클라이언트는 인증서의 유효성을 검증합니다.
    - **인증 기관의 신뢰성 확인**: 인증서가 **신뢰할 수 있는 CA에 의해 서명되었는지 확인합니다.**
    - **인증서의 유효 기간 확인**: 인증서가 만료되지 않았는지 확인합니다.
    - **인증서의 도메인 일치 확인**: 인증서에 명시된 도메인이 실제 접속하려는 도메인과 일치하는지 확인합니다.

  #### 4) 세션 키 생성 및 교환

  - **클라이언트는 임의의 대칭 키(세션 키)를 생성하고 이를 서버의 공개키를 사용하여 암호화한 후 서버에 전송**합니다.

  ![image](https://github.com/user-attachments/assets/0cff3c78-1ab9-4711-91b9-94c92e5c9fca)


  - 공개키로 암호화한 클라이언트의 대칭키를 서버에서 개인키로 복호화합니다.

  ![image](https://github.com/user-attachments/assets/e883e52b-72cf-4edf-a3b9-f87589a02099)


  #### 5) 암호화된 데이터 전송

  - 클라이언트와 서버는 세션 키를 사용하여 데이터를 암호화하고, 이를 통해 안전하게 데이터를 주고받습니다.

  - 모든 통신은 대칭 키 암호화를 사용하여 빠르고 효율적으로 이루어집니다.

    ![image](https://github.com/user-attachments/assets/f95f5606-05b8-4150-899f-655ba4ce9705)

    









